?qf
qf(0.05, 13, 7)
qf(0.025, 13, 7)
qf(0.005, 13, 7)
qf(0.995, 13, 7)
qf(0.995, 13, 7, lower.tail = TRUE)
qf(0.995, 13, 7, lower.tail = FALSE)
blueberry_data = read.csv("~/Desktop/Final/blueberry_data.csv")
names(blueberry_data) = c("Fruit_ID",
"Spectral_Band_Value",
"Measured_Size_mm")
# Load required library
library(ggplot2)
# Create the plot
ggplot(blueberry_data, aes(x = Spectral_Band_Value, y = Measured_Size_mm)) +
geom_point(color = "blue", size = 7.5) +
geom_smooth(method = "lm", se = FALSE, color = "black", linewidth = 2) +
labs(
title = "Blueberry Size vs. Spectral Band Value",
x = "Spectral Band Value",
y = "Measured Size (mm)"
) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 30),
axis.title.x = element_text(face = "bold", size = 25),
axis.title.y = element_text(face = "bold", size = 25),
axis.text.x = element_text(face = "bold", size = 25),
axis.text.y = element_text(face = "bold", size = 25)
)
# Optional: Calculate and display regression equation
model <- lm(Measured_Size_mm ~ Spectral_Band_Value, data = blueberry_data)
summary(model)
rstandard(model)
honey_data$std_residuals <- model$residuals
model$residuals
# Add standardized residuals and fitted values
# honey_data$std_residuals <- rstandard(model)
honey_data$std_residuals <- model$residuals
rm(list=ls())
library(ggplot2)
set.seed(42)
# Simulate data
honey_data <- data.frame(
temperature_K = runif(120, 260, 330),
water_content = rep(c(0.15, 0.175, 0.20), each = 40)
)
# Generate: ln(Viscosity) = 51.98 - 38.363*W - 0.1398*T
honey_data$ln_viscosity <- 51.98 - 38.363*honey_data$water_content -
0.1398*honey_data$temperature_K +
rnorm(120, 0, 0.25)
honey_data$viscosity <- exp(honey_data$ln_viscosity)
# Fit model
# model <- lm(ln_viscosity ~ water_content + temperature_K, data = honey_data)
# model <- lm(ln_viscosity ~ water_content, data = honey_data)
model <- lm(ln_viscosity ~ temperature_K, data = honey_data)
summary(model)
# Plot
# ggplot(honey_data, aes(x = temperature_K, y = ln_viscosity,
#                        color = factor(water_content))) +
ggplot(honey_data, aes(x = temperature_K, y = ln_viscosity)) +
geom_point(alpha = 0.8, size = 5, color = "steelblue") +
geom_smooth(method = "lm", se = FALSE, color = "darkred", linewidth = 5) +
labs(title = "Ln(Honey Viscosity) vs Temperature",
x = "Temperature (K)",
y = "ln(Viscosity)") +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 25),
axis.title = element_text(face = "bold", size = 20),
axis.text = element_text(size = 20)
)
# write.csv(honey_data, "honey_viscosity_simulated.csv", row.names = FALSE)
# Load library
library(ggplot2)
# Assuming honey_data is already loaded
# If not, load from CSV:
# honey_data <- read.csv("honey_viscosity_simulated.csv")
# Create plot with specified formatting
ggplot(honey_data, aes(x = temperature_K, y = ln_viscosity)) +
geom_point(alpha = 0.6, size = 3, color = "steelblue") +
geom_smooth(method = "lm", se = TRUE, color = "darkred", linewidth = 1.2) +
labs(title = "Ln(Honey Viscosity) vs Temperature",
x = "Temperature (K)",
y = "ln(Viscosity)") +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 25),
axis.title = element_text(face = "bold", size = 20),
axis.text = element_text(size = 20)
)
# Save plot
# ggsave("honey_viscosity_plot.png", width = 12, height = 8, dpi = 300)
# Load library
library(ggplot2)
# Fit the regression model
model <- lm(ln_viscosity ~ temperature_K, data = honey_data)
# Add standardized residuals and fitted values
# honey_data$std_residuals <- rstandard(model)
honey_data$std_residuals <- model$residuals
honey_data$std_residuals
honey_data$fitted_values <- fitted(model)
# Create standardized residual plot
ggplot(honey_data, aes(x = fitted_values, y = std_residuals)) +
geom_point(alpha = 0.8, size = 5, color = "steelblue") +
geom_hline(yintercept = 0, color = "darkred", linetype = "dashed", linewidth = 2) +
geom_hline(yintercept = c(-2, 2), color = "gray50", linetype = "dotted", linewidth = 1.5) +
# geom_smooth(method = "loess", se = FALSE, color = "orange", linewidth = 2) +
labs(
title = "Standardized Residual Plot",
x = "Fitted Values",
y = "Standardized Residuals"
) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 25),
axis.title = element_text(face = "bold", size = 20),
axis.text = element_text(size = 20)
)
# Save the plot
# ggsave("honey_standardized_residual_plot.png", width = 12, height = 8, dpi = 300)
# Load library
library(ggplot2)
# Fit the regression model
model <- lm(ln_viscosity ~ temperature_K, data = honey_data)
# Add NON-STANDARDIZED residuals and fitted values
honey_data$residuals <- residuals(model)  # Changed from rstandard() to residuals()
honey_data$fitted_values <- fitted(model)
# Create NON-STANDARDIZED residual plot
ggplot(honey_data, aes(x = fitted_values, y = residuals)) +
geom_point(alpha = 0.8, size = 5, color = "steelblue") +
geom_hline(yintercept = 0, color = "darkred", linetype = "dashed", linewidth = 2) +
labs(
title = "Residual Plot",
x = "Fitted Values",
y = "Residuals"
) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 25),
axis.title = element_text(face = "bold", size = 20),
axis.text = element_text(size = 20)
)
# Create NON-STANDARDIZED residual plot
ggplot(honey_data, aes(x = fitted_values, y = residuals)) +
geom_point(alpha = 0.8, size = 10, color = "steelblue") +
geom_hline(yintercept = 0, color = "darkred", linetype = "dashed", linewidth = 2) +
labs(
title = "Residual Plot",
x = "Fitted Values",
y = "Residuals"
) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 25),
axis.title = element_text(face = "bold", size = 20),
axis.text = element_text(size = 20)
)
# Create NON-STANDARDIZED residual plot
ggplot(honey_data, aes(x = fitted_values, y = residuals)) +
geom_point(alpha = 0.8, size = 7, color = "steelblue") +
geom_hline(yintercept = 0, color = "darkred", linetype = "dashed", linewidth = 2) +
labs(
title = "Residual Plot",
x = "Fitted Values",
y = "Residuals"
) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 25),
axis.title = element_text(face = "bold", size = 20),
axis.text = element_text(size = 20)
)
# Fit the regression model
model <- lm(ln_viscosity ~ temperature_K, data = honey_data)
model
new_value = data.frame(temperature_K = 297.8)
predict(model, new = new_value)
library(ggplot2)
set.seed(42)
# Simulate data
honey_data <- data.frame(
temperature_K = runif(120, 260, 330),
water_content = rep(c(0.15, 0.175, 0.20), each = 40)
)
honey_data
library(ggplot2)
set.seed(42)
# Simulate data
honey_data <- data.frame(
temperature_K = runif(120, 260, 330),
water_content = rep(c(0.15, 0.175, 0.20), each = 40)
)
# Generate: ln(Viscosity) = 51.98 - 38.363*W - 0.1398*T
honey_data$ln_viscosity <- 51.98 - 38.363*honey_data$water_content -
0.1398*honey_data$temperature_K +
rnorm(120, 0, 0.25)
honey_data$viscosity <- exp(honey_data$ln_viscosity)
# Fit model
# model <- lm(ln_viscosity ~ water_content + temperature_K, data = honey_data)
# model <- lm(ln_viscosity ~ water_content, data = honey_data)
model <- lm(ln_viscosity ~ temperature_K, data = honey_data)
summary(model)
honey_data
honey_data[, c("temperature_K", "viscosity")]
honey_data[1:3,118:120, c("temperature_K", "viscosity")]
honey_data[c(1:3,118:120),
c("temperature_K", "viscosity")]
rm(list=ls)
rm(list=ls())
library(ggplot2)
set.seed(42)
# Simulate data
honey_data <- data.frame(
temperature_K = runif(120, 260, 330),
water_content = rep(c(0.15, 0.175, 0.20), each = 40)
)
# Generate: ln(Viscosity) = 51.98 - 38.363*W - 0.1398*T
honey_data$ln_viscosity <- 51.98 - 38.363*honey_data$water_content -
0.1398*honey_data$temperature_K +
rnorm(120, 0, 0.25)
honey_data$viscosity <- exp(honey_data$ln_viscosity)
# Fit model
# model <- lm(ln_viscosity ~ water_content + temperature_K, data = honey_data)
# model <- lm(ln_viscosity ~ water_content, data = honey_data)
model <- lm(ln_viscosity ~ temperature_K, data = honey_data)
summary(model)
# Generate: ln(Viscosity) = 51.98 - 38.363*W - 0.1398*T
honey_data$ln_viscosity <- 51.98 - 38.363*honey_data$water_content -
0.1398*honey_data$temperature_K +
rnorm(120, 0, 0.25)
honey_data$viscosity <- exp(honey_data$ln_viscosity)
honey_data
# Fit model
# model <- lm(ln_viscosity ~ water_content + temperature_K, data = honey_data)
# model <- lm(ln_viscosity ~ water_content, data = honey_data)
model <- lm(ln_viscosity ~ temperature_K, data = honey_data)
summary(model)
library(ggplot2)
set.seed(42)
# Simulate data
honey_data <- data.frame(
temperature_K = runif(120, 260, 330),
water_content = rep(c(0.15, 0.175, 0.20), each = 40)
)
# Generate: ln(Viscosity) = 51.98 - 38.363*W - 0.1398*T
honey_data$ln_viscosity <- 51.98 - 38.363*honey_data$water_content -
0.1398*honey_data$temperature_K +
rnorm(120, 0, 0.25)
honey_data$viscosity <- exp(honey_data$ln_viscosity)
# Fit model
# model <- lm(ln_viscosity ~ water_content + temperature_K, data = honey_data)
# model <- lm(ln_viscosity ~ water_content, data = honey_data)
model <- lm(ln_viscosity ~ temperature_K, data = honey_data)
summary(model)
library(ggplot2)
set.seed(42)
# Simulate data
honey_data <- data.frame(
temperature_K = runif(120, 260, 330),
water_content = rep(c(0.15, 0.175, 0.20), each = 40)
)
# Generate: ln(Viscosity) = 51.98 - 38.363*W - 0.1398*T
honey_data$ln_viscosity <- 51.98 - 38.363*honey_data$water_content -
0.1398*honey_data$temperature_K +
rnorm(120, 0, 0.25)
honey_data$viscosity <- exp(honey_data$ln_viscosity)
# Fit model
# model <- lm(ln_viscosity ~ water_content + temperature_K, data = honey_data)
# model <- lm(ln_viscosity ~ water_content, data = honey_data)
model <- lm(ln_viscosity ~ temperature_K, data = honey_data)
summary(model)
honey_data[c(1:3,118:120),
c("temperature_K", "viscosity")]
honey_data %>% order_by(temperature_K)
honey_data %>% order(temperature_K)
library(dplyr)
honey_data %>% arrange(temperature_K)
honey_data = honey_data %>% arrange(temperature_K)
honey_data[c(1:3,118:120),
c("temperature_K", "viscosity")]
120/3
120/2
honey_data[c(1:3, 59:61, 118:120),
c("temperature_K", "viscosity")]
honey_data
lm( log(honey_data$viscosity) ~ honey_data$temperature_K )
summary( lm( log(honey_data$viscosity) ~ honey_data$temperature_K ) )
honey_data = honey_data %>% arrange(temperature_K)
honey_data[c(1:3, 118:120), ]
honey_data[c(1:3, 118:120),
c("temperature_K", "viscosity")]
round(honey_data[c(1:3, 118:120),
c("temperature_K", "viscosity")] , 3)
model
summary(model)
round(summary(model) ,  3)
round(summary(model),  3)
class(summary(model))
print(summary(model),digits=3)
print(summary(model),digits=2)
print(summary(model),digits=1)
round(honey_data[c(1:3, 118:120),
c("temperature_K", "viscosity")] , 3)
names(honey_data)
round(honey_data[c(1:3, 118:120),
c("temperature_K", "viscosity", "ln_viscosity")] , 3)
new_value = data.frame(temperature_K = 329.222)
predict(model, new = new_value)
exp( predict(model, new = new_value) )
citation("dplyr")
citation("dplyr")
citation("ggplot2")
citation("learnr")
citation("webr")
cat("\014")
citation("dplyr")
citation("ggplot2")
citation("learnr")
citation("webr")
library(tidyverse)
library(raster)
library(sf)
aus <- getData("GADM", country = "AUS", level = 0) %>%
disaggregate() %>%
geometry()
library(geodata)
install.packages("geodata")
install.packages("geodata", dependencies = T)
aus <- getData("GADM", country = "AUS", level = 0) %>%
disaggregate() %>%
geometry()
?getData
aus <- getData("GADM", country = "AUS", level = 0)
??geodata
library(tidyverse)
# library(raster)
library(sf)
library(geodata)
aus <- getData("GADM", country = "AUS", level = 0) %>%
disaggregate() %>%
geometry()
aus <- getData("GADM", country = "AUS", level = 0) %>%
disaggregate()
aus <- getData("GADM", country = "AUS", level = 0)
aus <- raster::getData("GADM", country = "AUS", level = 0)
aus_sf <- sf::st_as_sf(aus)
aus <- gadm(country = "AUS", level = 0, path = tempdir())
aus <- gadm(country = "AUS", level = 0, path = tempdir()) %>%
disaggregate() %>%
geometry()
library(tidyverse)
# library(raster)
library(sf)
library(geodata)
aus <- gadm(country = "AUS", level = 0, path = tempdir()) %>%
disaggregate() %>%
geometry()
aus <- gadm(country = "AUS", level = 0, path = tempdir()) %>%
disaggregate()
aus <- gadm(country = "AUS", level = 0, path = tempdir()) %>%
raster::disaggregate()
install.packages("terra", dependencies = T)
library(tidyverse)
# library(raster)
library(sf)
library(geodata)
library(terra)
aus <- gadm(country = "AUS", level = 0, path = tempdir()) %>%
disaggregate() %>%
geometry()
library(geodata)
library(terra)
library(sf)
aus <- geodata::gadm("AUS", level = 0, path = tempdir()) |>
terra::disagg()
ggplot() +
geom_sf(data = st_as_sf(aus))
library(geodata)
library(terra)
ggplot() +
geom_sf(data = st_as_sf(aus))
source("~/Desktop/hexwall.R")
hexwall(
"hexstickers",
sticker_width = 500,
coords = hex_points@coords,
sort_mode = "colour"
)
hex_points <- aus %>%
spsample(type = "hexagonal", cellsize = 2)
hex_points <- aus %>%
spsample(type = "hexagonal", cellsize = 2)
hex_points <- aus %>%
spsample(type = "hexagonal", cellsize = 2)
hex <- rast(ext(aus), resolution = 2)      # 2 degrees if aus is lon/lat
hex <- as.polygons(hex, hexagons = TRUE)
hex <- intersect(hex, aus)
hex_points <- centroids(hex)
aus_hex <- HexPoints2SpatialPolygons(hex_points, dx = 2)
library(sp)
hex_points_sp <- as(hex_points, "Spatial")     # SpatVector points -> SpatialPoints
aus_hex_sp <- sp::HexPoints2SpatialPolygons(hex_points_sp, dx = 2)
ggplot() +
geom_sf(data = st_as_sf(aus)) +
geom_sf(data = st_as_sf(aus_hex), colour = "blue", fill = NA)
ggplot() +
geom_sf(data = st_as_sf(aus)) +
geom_sf(data = st_as_sf(aus_hex_sp), colour = "blue", fill = NA)
hexwall(
"hexstickers",
sticker_width = 500,
coords = hex_points@coords,
sort_mode = "colour"
)
library(tidyverse)
library(sf)
library(geodata)
# 1) Australia boundary (sf)
aus <- geodata::gadm("AUS", level = 0, path = tempdir()) |>
st_as_sf() |>
st_make_valid()
ggplot() +
geom_sf(data = aus)
# 2) Hex grid (polygons) with ~2 degree spacing if aus is lon/lat
hex <- st_make_grid(aus, cellsize = 2, square = FALSE) |>
st_sf() |>
st_intersection(st_geometry(aus))  # clip to Australia
# 3) Hex "points" = centroids, plus coords tibble (x,y) for hexwall()
hex_points <- st_centroid(hex)
coords <- st_coordinates(hex_points) |>
as_tibble() |>
transmute(x = X, y = Y)
# Optional: what you had before
coords
# 4) Plot boundary + hexes
ggplot() +
geom_sf(data = aus) +
geom_sf(data = hex, colour = "blue", fill = NA)
# 5) Run hexwall using your attached script
source("~/Desktop/hexwall.R")  # :contentReference[oaicite:0]{index=0}
hexwall(
"hexstickers",
sticker_width = 500,
coords = coords,
sort_mode = "colour"
)
# 5) Run hexwall using your attached script
source("~/Desktop/hexwall.R")  # :contentReference[oaicite:0]{index=0}
# 5) Run hexwall using your attached script
source("~/Desktop/hexwall.R")  # :contentReference[oaicite:0]{index=0}
hexwall(
"hexstickers",
sticker_width = 500,
coords = coords,
sort_mode = "colour"
)
library(tidyverse)
library(terra)
library(sf)
library(geodata)
# 1. Get Data (using geodata instead of raster)
# 'path' is mandatory in geodata; tempdir() is a safe default
aus_terra <- geodata::gadm(country = "AUS", level = 0, path = tempdir())
setwd("~/Library/Mobile Documents/com~apple~CloudDocs/Documents/Documents/Projects/STA258_Tutorials/tutorials")
setwd("~/Library/Mobile Documents/com~apple~CloudDocs/Documents/Documents/Projects/STA258_Tutorials")
setwd("~/Library/Mobile Documents/com~apple~CloudDocs/Documents/Documents/Projects/UTM_FSU_Biostats")
setwd("~/Library/Mobile Documents/com~apple~CloudDocs/Documents/Documents/Projects/UTM_FSU_Biostats")
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::clean_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::clean_book()
