# Sample Chapter: Introduction to Mathematical Modelling

## Foundations {#sec:foundations}

::: {.definition name="Model" #Model}
A mathematical model is a mathematical framework describing a simplified version of reality.
:::

Some examples of mathematical models from Definition \@ref(def:Model) include

- **Population Growth Model**: A model that describes how the size of a population changes over time depending on birth rates and death rates.

- **Supply and Demand Model**: A model in economics that relates the price of a good to its availability (supply) and how much people want it (demand). It predicts that the price will adjust until the amount supplied equals the amount demanded (market equilibrium).

- **Projectile Motion Model**: A physics model for the path of an object thrown into the air.

- **Linear Regression Model**: A statistical model that expresses the relationship between a response variable (like exam score) and one or more explanatory variables (like study hours).


## Introduction to Compartmental Modelling Thinking

As varying global health concerns persist, it is imperative to understand the complexities within the spread of infectious diseases. The most prevalent of which is compartmental modelling. This is a model that follows the change in proportions of populations in different compartments over time. The most common form of this type of model is the SIR model, organized in three separate compartments: Susceptible, Infected, and Recovered. Additional forms of this model may incorporate more compartments to attempt to enhance predictability. As computational power and modelling in the field of epidemiology have evolved, the growing use of parsimonious models, such as the SIR model, has become more relevant. These models utilize simpler processes by using accessible key data across broader conditions to produce a sufficiently predictive and generalizable model.

### **Approach to Compartmental Modelling**

Referring back, compartmental modelling is the framework for prediction in epidemiology. The fundamental thinking behind the most common compartmental model, the SIR model, is that at any given point, a person will fall into either the Susceptible, Infected, or Recovered compartments, under the model's assumptions.

- **Susceptible**: Those at risk of the disease, but not yet infected

- **Infected**: Those currently infected, and can actively spread the disease to those who are Susceptible

- **Recovered**: Individuals who have recovered and developed immunity, or died from the disease

Diving deeper, the relationship between each of these compartments is defined by differential equations, specifically ODEs and dynamical systems. These differential equations depict the movement between S and I, as well as I and R. These will be discussed further in Chapter 2. X. 

Other forms of the SIR model exist, in which compartments are added to depict realistic features of disease transmission. Each of these models utilizes an additional compartment that accounts for specific epidemiological situations, described below:

- **SEIR**:
  - _Exposed_ - Represents individuals who are infected but not yet infectious
  - Accounts for the latency period, in which individuals may be infected, yet are not able to transmit the disease

- **SAIR**:
  - _Asymptomatic_ - Represents individuals who are infected but do not express symptoms
  - Accounts for hidden transmission by individuals without symptoms
  
- **SIRS**:
  - _Susceptible_ - An additional "S" compartment at the end represents those who have recovered but lose immunity and become susceptible again
  - Accounts for the misassumption that those who recover retain lifelong immunity

- **SVIR**:
  - _Vaccinated_ - Represents individuals who have received immunity to a varying extent from vaccinations
  - Accounts for how vaccinations reduce the population of susceptible individuals

These variations of the SIR model will be discussed at legnth in Chapter 5 and 6.1.

### **Interactions Between Compartments**

Compartmental models are designed specifically such that the people within move from one compartment to another. This movement is called flow. Below are equations representing the net flow of individuals into and out of  Susceptible and Infectious compartments, respectively. This flow is represented by the differential in both equations. These equations will be looked at in-depth in Chapter 3.
$$
\frac {dS}{dt} = -\beta SI + \gamma I
$$
$$
\frac {dI}{dt} = +\beta SI - \gamma I
$$
**Defining Parameters**:

- Differentials ($\frac {dS}{dt} and \frac {dI}{dt}$): Net Flow of individuals in and out of specific compartments

- $\beta SI$: Total Rate of New Infections in a Population

  - $\beta$: Transmission Rate
  
- $\gamma I$: Recovery Rate of Infectious Individuals

  - $\gamma$: Recovery Rate

Now that each term of the equation is defined, we can start to understand the interactions occurring. First we will dive into the meaning of the signage of each term:

- Positive (+): Represents Inflow; Adding individuals to a compartment

- Negative (-): Represents Outlfow; Removing individuals from a compartment

In each equation, either $\beta SI$ and $\gamma I$ contain inverse signs, positive and negative. This explicitly defines the relation between the parameters in each context. Looking at $\beta SI$, in the first equation, the sign is negative, indicating that the outflow from the Susceptible compartment as individuals are removed as they become infected and a part of the Infectious compartment; however, in the second equation, the sign is positive, representing the inflow into the Infectious department as individuals become infected and leave the susceptible department. The loss depicted in one equation is gained in the other equation. This relationship is the same for $\gamma I$. The signage is imperative to understand the context in which the flow is occurring. While both equations define the same flow, the interaction at play is defined by the sign of the parameters, illustrating the perspective of each compartment from which the equation is viewed.
  
### **Benefits of Parsimonious Models**

As seen, SIR models and other forms can provide great predictive power. Recently, parsimonious models have become of interest in epidemiological modelling. These models are based on the premise that the simplest answer is the best. Allude to earlier in this section where parsimonious models are defined. These are able to use significantly less data and parameters in order to produce a generalized and understandable model. In a real-world setting, these models have been effectively utilized to predict disease outbreaks. Not only are these models more accurate than those with more complexity, but they can also be applied to a multitude of situations; additionally, with the presence of noisy data, these models can also avoid overfitting.

### **Limitations of Compartmental and Parsimonious Models**

While these models are effective at predicting and understanding the spread of disease, there are issues with both their simplicity and complexity. These models must use a vast amount of assumptions in order to be feasibly produced, which comes at the cost of precision and realism. Some of these assumptions include the interactions between humans, fixed parameters, and assumed immunity. In the real world, these assumptions are not constant or realistic, resulting in a model that may not accurately depict the spread of disease. As a result, additional compartments have been added, such as in SEIR, SAIR, SIRS, and SVIR models discussed earlier. However, the addition of more compartments creates further intricacies. The foundational models discussed involve three to four compartments; other examples of models may contain a greater number of compartments. While this may improve the precision of the model, as discussed prior, real-world data is noisy. This may lead to overfitting the data, resulting in a lack of generalizability and potentially reduced predictive ability.

## Exponential Growth and Decay

Exponential models describe processes that grow or decline at rates proportional to their current size. In the case of exponential growth, the model is

$$
\frac{dN}{dt} = rN, \quad r > 0,
$$

which has the solution

$$
N(t) = N_0 e^{rt}.
$$

When the rate $r$ is negative, we obtain exponential decay, where the quantity decreases over time:

$$
N(t) = N_0 e^{rt}, \quad r < 0.
$$

These models are widely used in contexts such as population growth, radioactive decay, and compound interest.


```{r ExpGrowthDecay, echo=FALSE, fig.align='center', fig.cap="Exponential growth (left) and exponential decay (right) with initial value $N_0=10$; rates $r=0.3$ and $r=-0.3$.", fig.show='hold', out.width=c("50%","50%")}
# Exponential model
exp_model <- function(t, r, N0) N0 * exp(r * t)

# Parameters and grid
N0 <- 10
t  <- seq(0, 10, length.out = 200)

# Plot: growth
plot(t, exp_model(t, r = 0.3,  N0 = N0), type = "l", lwd = 2, col = "blue",
     xlab = "Time (t)", ylab = "N(t)", main = "Exponential Growth")
abline(h = N0, lty = 2, col = "gray")

# Plot: decay
plot(t, exp_model(t, r = -0.3, N0 = N0), type = "l", lwd = 2, col = "red",
     xlab = "Time (t)", ylab = "N(t)", main = "Exponential Decay")
abline(h = 0, lty = 2, col = "gray")
```


## Logistic Model

The logistic growth model describes how a population grows over time with limited resources.

The differential equation form is

$$
\frac{dN}{dt} = rN \left(1 - \frac{N}{K}\right),
$$

where  
- $N(t)$ = population size at time $t$  
- $r$ = intrinsic growth rate  
- $K$ = carrying capacity.  

The solution to this differential equation is

$$
N(t) = \frac{K}{1 + \left(\frac{K - N_0}{N_0}\right)e^{-rt}},
$$

where $N_0$ is the initial population size at $t=0$.  

As $t \to \infty$, $N(t) \to K$, meaning the population stabilizes at the carrying capacity.


```{r LogisticExample, fig.cap="An illustration of the logisitc model for a growth rate of 0.5, a carrying capacity of 100 and an initial population size of 5.", echo=FALSE, fig.align='center', warning=FALSE}
# Logistic growth function
logistic <- function(t, r, K, N0) {
  K / (1 + ((K - N0) / N0) * exp(-r * t))
}

# Parameters
r  <- 0.5      # intrinsic growth rate
K  <- 100      # carrying capacity
N0 <- 5        # initial population size

# Time grid
t <- seq(0, 20, length.out = 200)

# Population values
N <- logistic(t, r, K, N0)

# Plot
plot(t, N, type="l", lwd=2, col="steelblue2",
     xlab="Time (t)", ylab="Population size N(t)",
     main="Logistic Growth Model")
abline(h=K, lty=2, col="lightcoral")
legend("bottomright", legend=c("Population", "Carrying capacity (K)"),
       col=c("steelblue2", "lightcoral"), lty=c(1,2), lwd=2, bty="n")
```

