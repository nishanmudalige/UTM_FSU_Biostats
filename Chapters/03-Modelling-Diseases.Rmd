# Modelling disease dynamics with ODEs


## Solving the SI Model {#sec:SI_model}

```{r SIdiagram, echo=FALSE, fig.align='center', out.width='20%'}
knitr::include_graphics("Images/Compartmental Diagrams/SI.png")

```

$$
S+I=N
$$

$$
S+I=1
$$ 

$$
I=1-S
$$

$$
\frac {dS}{dt} = -\beta SI + \gamma I
$$

$$
\frac {dI}{dt} = \beta SI - \gamma I
$$

$$
\frac {dS} {dt}= -\beta S(1-S) + \gamma (1-S) = (\gamma - \beta S)(1-S)
$$

$$
\int \frac {1}{(\gamma - \beta S)(1-S)} dS = \int dt
$$

Partial Fractions 
$$
\frac {A}{\gamma - \beta S} + \frac {B}{1-S}= \frac {A(1-S)+B( \gamma - \beta S)}{( \gamma - \beta S)(1-S)}
$$ 
So then: 
$$
A + \beta \gamma = 1
$$

$$
A + B \beta =0
$$

$$
A = \frac {1}{\beta - \gamma }
$$

$$
B = \frac {1}{\gamma - \beta}
$$

$$
\frac {1}{\gamma - \beta} ln| \frac{\gamma - \beta S}{1-S} | = t+C
$$

Solve for S(t)

$$
S(t)= \frac {\gamma - Ce^{(\gamma - \beta )t}}{\beta - Ce^{(\gamma - \beta)t}}
$$

$$
S(0) = \frac {\gamma - C}{\beta -C}
$$

$$
S_0(\beta - C) = \gamma -C
$$

$$
S_0 \beta - \gamma = C(S_0 -1)
$$

$$
C = \frac{S_0 \beta - \gamma}{S_0 -1}
$$


## Solving the SIR Model

```{r SIRdiagram, echo=FALSE, fig.align='center', out.width='40%'}
knitr::include_graphics("Images/Compartmental Diagrams/SIR.png")
```

Rough notes on Dynamical Systems (Qualitative Analysis). SIR model as example. 

**System of Equations:**

1. $\frac{dS}{dt} = - \beta SI + \alpha R$

2. $\frac{dI}{dt} = \beta SI - \gamma I$

3. $\frac{dR}{dt} = \gamma I - \alpha R$

Note that $S,I,R \in [0,1]$ and $S + I + R = 1$. So $R = 1 - S - I$. 

Plugging into the system of equations we get 
$$
\frac{dS}{dt} = - \beta SI + 2(1 - S - I)
$$

**Equilibria: (new system of equations at equilibria)**

1. $0 = -\beta SI + \alpha R$

2. $0 = \beta SI - \gamma I \Rightarrow 0 = (\beta S - \gamma) I$

3. $0 = -\gamma I + \alpha R$

From equation 2 we get: $I = 0$, or $S=\frac{\gamma}{\beta}$

Then plugging in $I = 0$ into the system of equations: 

1. $0 = \alpha R$

3. $0 = -\alpha R$

Solving for $R$ from these 2 equations, we get $R^* = 0$

Since $R = 1 - S - I$, $R^* = 0$, and $I = 0$, then $S^* = 1$ (note: another way to write $S^*$ is $\overline S$). We use the asterisk or bar to indicate equilibrium notation. 

Therefore, at Equilibrium: 
$$
(S^*, I^*) = (1, 0)
$$

Also, plugging in $S = \frac{\gamma}{\beta}$ into the system of equations: 

3. $0 = -\gamma I + \alpha (1 - \frac{\gamma}{\beta} - I)$

$0 = \gamma I - \alpha (1 - \frac{\gamma}{\beta} - I)$

$\alpha (1 - \frac{\gamma}{\beta}) = I (\gamma + \alpha)$

Solving for I we get: 
$$ 
I^* =  \frac{\alpha (1 - \frac{\gamma}{\beta})}{\gamma + \alpha} 
$$

Endemic equilibrium (EE) is: 
$$
(S^*, I^*) = ( \frac{\gamma}{\beta}, \frac{ \alpha (1- \frac{\gamma}{\beta}) } {\gamma + \alpha})
$$

where $\gamma < \beta$ or $R_0 = \frac{\beta}{\gamma} > 1$

The disease spreads, otherwise it doesnâ€™t. (?)