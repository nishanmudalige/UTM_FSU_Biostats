# Equilibrium Stability Analysis 

## Introduction to the Chapter
In Chapter 3.4, we briefly introduced equilibrium and $R_0$ (*Definition* \@ref(def:R0)) for examining stability in **equilibrium** (*Definition* \@ref(def:Equilibrium)). Chapter 4 will expand on the topic of equilibrium through **linear stability analysis**. 

::: {.definition name="Linear Stability Analysis" #LSA}
A method providing the local stability of each equilibrium, as we approximate the solutions near the equilibrium. The approach to linear stability analysis involves determining the eigenvalues of the Jacobian matrix at the given equilibrium. We can linearize the system of equations around the equilibria with the Jacobian matrix and find the characteristic polynomial whose roots are the eigenvalues. We will show that all the eigenvalues have negative real parts to maintain the local stability of the equilibrium. See Chapter 1.2 for the recommended linear algebra and calculus background. 
:::

This chapter will explore both the direct calculation of eigenvalues, as well as some alternative / indirect methods of showing stability. 

**References:** [@brauer2019] [@blackwood2018]


## Linear Stability Analysis for the SIR Model 

The stability of an equilibrium in a **compartmental model** (*Definition* \@ref(def:Compartmental)) is determined by the signage of the eigenvalues ($\lambda$) of the Jacobian Matrix (J). In this section, we will solve for the eigenvalues of the SIR model at the Disease Free Equilibrium (DFE) and the Endemic Equilibrium (EE).

### Direct Calculation 

The SIR model has 3 compartments, and thus, 3 differential equations. The equation below represents the balance of each compartment, totaling to 1. We can rearrange this to substitute R out, as shown below.

$$S+I+R=1 \Rightarrow R=1-S-I$$
Now, we have our 3 system of equations, ($\dot{S}, \dot{I}, \dot{R}$), in which $\dot{S}, \dot{I}$ represent Functions F and G respectively. By using the equation above we are able substitute R, and reduce our system from 3 to two equations, ($\dot{S}, \dot{I}$)
$$
\begin{align*}
\dot{S} &= F(S,I) = -\beta SI + \alpha R \\
\dot{I} &= G(S,I) = \beta SI - \gamma I \\
\dot{R} &= \gamma I - \alpha R \\
\end{align*}$$

Our substitution results in these 2 equations for $\dot{S}, \dot{I}$:

\begin{align}
\dot{S} &= -\beta SI + \alpha(1-S-I) \\

\dot{I} &= \beta SI - \gamma I
\end{align}

The Jacobian Matrix (J) represent a matrix of the partial derivatives of the system of Functions **F** and **G**. As stated before, this is represented by $\dot{S}, \dot{I}$

$$J = \begin{bmatrix} \frac{dF}{dS} & \frac{dF}{dI} \\ \frac{dG}{dS} & \frac{dG}{dI}\end{bmatrix}$$
By substituting our system of equations, where $S^*$ and $I^*$ are the values of S and I at our specific equilibrium point, the Jacobian Matrix is as follows:

$$J = \begin{bmatrix}-\beta I^* - \alpha & -\beta S^*-\alpha \\ \beta I^* & \beta S^* - \gamma\end{bmatrix}$$

#### At Disease-Free Equilibrium

The **Disease-Free Equilibrium (DFE)** (*Definition* \@ref(def:DFE)) is the state in which the disease has been eradicated. Therefore, at DFE, $I^* = 0$ and $S^* = 1$. It is important to note that this equation must retain the balance from our earlier equation ($S+I+R = 0$), so $R^* = O$.

We can substitute our values for $I^*$ and $S^*$ at the DFE into our Jacobian Matrix before, so we get:

$$J_{DFE} = \begin{bmatrix}-\alpha & -\beta-\alpha \\ 0 & \beta-\gamma\end{bmatrix}$$

Next, we **solve for the eigenvalues** of the Jacobian Matrix by the formula $det(J-\lambda I_n) = 0$, where $det$ is the determinant, $J$ is the Jacobian Matrix, $\lambda$ is the eigenvalue, and $I_n$ is the identity matrix with $n$ dimensions.

Adding in the $J$ we solved for above and the identity matrix $I_2 = \begin{bmatrix} 1 & 0 \\ 0 & 1\end{bmatrix}$, we get: 

$$
0 = det(\begin{bmatrix}-\alpha & -\beta-\alpha \\ 0 & \beta-\gamma\end{bmatrix}-\lambda\begin{bmatrix} 1 & 0 \\ 0 & 1\end{bmatrix})
$$
We will now simplify the contents of the determinant using matrix operations. 

$$
\begin{align*}
\ 0 &= det(\begin{bmatrix}-\alpha & -\beta-\alpha \\ 0 & \beta-\gamma\end{bmatrix}+\begin{bmatrix}-\lambda & 0 \\ 0 & -\lambda\end{bmatrix}) \\ 
\ 0 &= det(\begin{bmatrix}-\alpha-\lambda & -\beta-\alpha \\ 0 & \beta-\gamma-\lambda\end{bmatrix}) \\
\end{align*}
$$
Evaluate the determinant of the matrix by the rule $det \left(\begin{bmatrix} A & B \\ C & D\end{bmatrix} \right) = AD-BC$. 
Applying this rule, we get: 

$$
0 = -(\alpha+\lambda)(\beta-\gamma-\lambda)
$$
Then, solve for the two eigenvalues.

$$
\begin{align*}
\ 0 =-(\alpha+\lambda_1) &\longrightarrow \lambda_1 = -\alpha\\
\ 0 =(\beta-\gamma-\lambda_2) &\longrightarrow \lambda_2 = \beta-\gamma \\
\end{align*}
$$

Therefore, the eigenvalues are $\lambda_1 = -\alpha$ and $\lambda_2 = \beta-\gamma$. 

::: {.definition name="Equilibrium Stability by Eigenvalues" #ESE}
- The equilibrium is **stable** if all the eigenvalues have negative real parts. 
- The equilibrium is **unstable** is any eigenvalue is positive. 
- The equilibrium stability is **inconclusive** if some eigenvalues are zero and the rest are negative.
:::

**Stability Analysis of eigenvalues at DFE** using *Definition* \@ref(def:ESE):  

- Stability of $\lambda_1$: 
$$\lambda_1 = -\alpha < 0$$
- Stability of $\lambda_2$: 
  - In this equation, we also produce $R_0$, in which we find the values for $R_O$ in which the DFE is stable
$$\lambda_2 = \beta - \gamma < 0 \Rightarrow \beta<\gamma \Rightarrow \frac{\beta}{\gamma} = R_0 < 1$$
  - The Disease Free Equilibrium is stable if $\frac{\beta}{\gamma} = R_0 < 1$

#### At Endemic Equilibrium

The Endemic Equilibrium \@ref(def:EE) represents the state in which the Disease persists. Our equations for $S^*$ and $I^*$ are as follows. These will be integral to solving the Jacobian Matrix for the Endemic Equilibrium:

We are able to find $I^*$ and $S^*$ by solving our system of equations ($\dot{S}, \dot{I}$) for each value:
\begin{align*}
\dot{S} &= -\beta SI + \alpha(1-S-I) \\
\dot{I} &= \beta SI - \gamma I \\
I^* &= \frac{\alpha (1 - \frac{\gamma}{\beta})}{\gamma + \alpha} \\
S^* &=\frac{\gamma}{\beta} \\
\end{align*}

It is important to note that $S^*$ is equal to $R_0$ so $R_0$ only makes sense if $R_0>1$

$$S^*=\frac{\gamma}{\beta}=\frac{1}{R_0}$$

  - Thus, if this equilibrium exists, the DFE is unstable.

Like previously, the Jacobian Matrix (J) represents a matrix of the partial derivatives of the system of Functions F and G. As stated before, this is represented by $\dot{S}, \dot{I}$. We are able to then subsitute our values for $S^*$ and $I^*$:

\begin{align*}
J &= \begin{bmatrix}-\beta I - \alpha & -\beta S-\alpha \\ \beta I & \beta S - \gamma\end{bmatrix} \\
J &= \begin{bmatrix}-\beta I^* - \alpha & -\gamma-\alpha \\ \beta I & 0\end{bmatrix}
\end{align*}

Next, we take the determinant, once again using the same process with the identity matrix:
$$
\begin{align*}
det(J-\lambda I) = 0 \\ 
det(\lambda I - J) = 0
\end{align*}$$

After distributing $\lambda$ and combining the identity matrix with the Jacobian Matrix, we end up with:

$$det(\begin{bmatrix}-\beta I* - \alpha -\lambda & -\gamma-\alpha \\ \beta I & -\lambda\end{bmatrix})$$
Using the same general rule of distribution of matricies, we produce this equation:

$$(\beta I^* + \alpha + \lambda)\lambda + \beta I^*(\gamma+\alpha) = 0$$
After distributing, the equation as follows is our characteristic equation, or a polynomial equation produced from the Jacobian Matrix, used to find eigenvalues. In this case, the characterisitic equation contains similar properties as a quadratic equation and will be treated as such when solving for eigenvalues.
  
$$\lambda^2 + (\beta I^* + \alpha)\lambda + \beta I^*(\gamma+\alpha) = 0$$

Where $a=\lambda^2, b=(\beta I^* + \alpha), c=\beta I^*(\gamma+\alpha)$

Substitute for $I^*$:

$$\lambda^2 + \alpha \left[ \frac{1 - \frac{1}{R_0}}{R_0 + \frac{\alpha}{\beta}} + 1 \right] + \alpha\beta(1-\frac{1}{R_0})=0$$

Subsitute a, b, c into quadratic equation:

$$\lambda = \frac{-\alpha \left[ \frac{1 - \frac{1}{R_0}}{R_0 + \frac{\alpha}{\beta}} + 1 \right] \pm \sqrt{(\beta I^* + \alpha)^2 - 4\beta I(\gamma+\alpha)}}{2}$$

Where $-\alpha \left[ \frac{1 - \frac{1}{R_0}}{R_0 + \frac{\alpha}{\beta}} + 1 \right]$ is negative due to the signage

Here, we can expand the discriminant to understand complexity:

$$(\beta I^* + \alpha)^2 - 4\beta I(\gamma+\alpha) = \beta^2 (I^*)^2 + \alpha^2 + 2\beta(I^*)^2 - 4\beta I \alpha - 4\beta I \gamma$$
$\lambda = \frac{-b}{2}$ $\pm$ Complex Number, where $\frac{-b}{2}$ is a real part.

$$
\begin{align*}
\lambda &= a \pm bi \\
\lambda_1 &= a + bi \\
\lambda_2 &= a-bi \\
\end{align*}$$

$Z=a+bi$ where $i=\sqrt{-1}$ and $a$ and $b$ are real;
$Re(Z)=$ $a$ real part of $Z$, and $Im(Z)=$ $b$, imaginary number.

$$b^2>b^2-4c>0$$
$$\lambda_1=\frac{{-b} + \sqrt{(b^2 - 4c)^2}}{2}<0$$

$\lambda_2=\frac{{-b} - \sqrt{(b^2 - 4c)}}{2}$ where $b^2>b^2 - 4c$, so

$$<\frac{{-b} - \sqrt{b^2}}{2}=0$$
With this knowledge, we can apply this to our equation:
$$\lambda = \frac{-(\beta I^*+\alpha) \pm \sqrt{(\beta I^* + \alpha)^2 - 4\beta I(\gamma+\alpha)}}{2}$$
Applying the rule, we are able to expand the discriminant:

  - Notice the $\pm$ and only focus on $+$ and drop $- 4\beta I(\gamma+\alpha)$ due to complexity

$$<\frac{-(\beta I^*+\alpha) \pm \sqrt{(\beta I^* + \alpha)^2}}{2}=\frac{-(\beta I^*+\alpha)+{(\beta I^* + \alpha)}}{2}=0$$

As a result, since all coefficients of the characteristic equation are positive, as well as the resulting discriminant denoting negative real roots, both eigenvalues are real and negative. Thus, the Endemic Equilibrium is stable for $R_0>1$.

#### A Note on Phase Diagrams

### Routh - Hurwitz Criteria

For stability, it must be shown that the real part of all the eigenvalues is negative. The Routh-Hourwitz Criteria provides a method to check if the eigenvalues are negative and the system is stable without needing to solve for the roots. Instead, the Routh-Herwitz criteria can determine if the eignenvalues are negative by looking at the coefficients. Depending on the degree of the polynomial, the criteria varies.

For a quadratic characteristic equation $$c_2\lambda^2 + c_1\lambda + c_0=0$$

the coefficients must all be positive. As long as $c_2$, $c_1$, and $c_0$ are positive the eigenvalues will be negative.

The quadratic characteristic equation can be used when there are 3 compartments. The SIR model, with the susceptible, infected, and recovered compartment, can be used with the quadratic characteristic equation.

For a cubic characteristic equation $$c_3\lambda^3+c_2\lambda^2 + c_1\lambda + c_0=0$$ the criteria are slightly more complicated. Here the conditions that must be met are :

$$
c_i>0 \\
c_1c_2>c_0c_3 \\
$$ 
And since $c_3 = 1$, the conditions are therefore: 
$$
c_i>0 \\
c_1c_2>c_0 \\
$$ 
As long as these conditions are met, it can be found that a cubic characteristic equation has only negative real parts and the system is therefore stable.

A cubic characteristic equation can be used for models with 4 compartments such as the SEIR (Susceptible, Exposed, Infected, Recovered) model, SAIR (Susceptible, Asymptomatic, Infected, Recovered) model, and the SIVR(Susceptible, Infected, Vaccinated, Recovered) model.

For a quartic characteristic equation $$c_4\lambda^4+ c_3\lambda^3+c_2\lambda^2 + c_1\lambda + c_0=0$$ the criteria are further complicated. Here the conditions that must be met are :

$$
c_i>0 \\
c_2c_3>c_1c_4 \\
c_1c_2c_3 - c_4c_1^2 > c_0c_3^2
$$ 
As long as these conditions are met, it can be found that a quartic characteristic equation has only negative real parts and the system is therefore stable.


### Descartes' Rule of Signs

Descartes' Rule of Signs is used to determine the number of potential real positive and/or negative roots.

$$c_2\lambda^2 + c_1\lambda + c_0 = 0$$

Using this general characterisitic equation, as seen when finding the eigenvalues of the Jacobian Matrix, we can understand how stable the equilibrium \@ref(def:Equilibrium) is in the system of differential equations. For stability to occur, all real roots and the real part of complex roots must be negative.

#### Case 1: Positive Roots with No Sign Changes

$$(+)(+)(+)$$

 - 0 sign changes from term to term

 - All terms are positive, denoted by each coefficient ($c_0, c_1, c_2,$) being positive.

   - Result: There are either 0 positive roots

#### Case 2: Negative Roots with Multiple Sign Changes

$$\begin{align*}
c_2(-\lambda)^2+c_1(-\lambda)+c_0=0 \\
c_2\lambda^2-c_1\lambda+c_0=0
\end{align*}$$

 - 2 sign changes from term to term
 - First term ($c_2\lambda^2$) and last term ($c_0$) are positive, while middle term ($c_1\lambda$) is negative
    - From first to second term, $+$ to $-$, first sign change
    - From second to third term, $-$ to $+$, second sign change
 - Number of real negative roots = Number of sign changes
    - Result: There are either 2 negative roots or 0 negative roots

#### Cases with One Sign Change:

Example:

$(-) \rightarrow (+) (+)$$\cdots$$\lambda \rightarrow$ 1 Positive Root

  - 1 Sign Change and Positive Coefficients = 1 Real Positive Root

$(-) (-) \rightarrow (+)$$\cdots$$-\lambda \rightarrow$ 1 Negative Root

  - 1 Sign Change and Negative Coefficients = 1 Real Negative Root

## Linear Stability Analysis for the SI Model 

For $S(t)$, $S=\frac{\gamma}{\beta}$

DFE: $I^*=0$, $S^*=1$

$$S(t) =\left[\begin{align*}&\dot{S}= -\beta SI + \alpha I\\&\dot{S}=(-\beta S \gamma)(1-S)\\&\dot{I} = \beta SI - \gamma I\\&J = -\beta(1-S) - (-\beta S + \gamma) = -\beta + \beta S + \beta S - \gamma = 2\beta S - \beta - \gamma\\&J_{DFE} = -\beta(1-1) - (-\beta + \gamma) = \beta - \gamma < 0 \rightarrow \beta < \gamma = R_0 < 1 \\&J_{EE} = 2\beta \left(\frac{\gamma}{\beta}\right) - \beta - \gamma = 2\gamma - \beta - \gamma = \gamma - \beta < 0 \rightarrow 1 < R_0\end{align*} \right]$$