<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Next Generation Matrix | Biostats E-book</title>
  <meta name="description" content="Bookdown hosted on github using bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.44 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Next Generation Matrix | Biostats E-book" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Bookdown hosted on github using bookdown::gitbook." />
  <meta name="github-repo" content="nishanmudalige/STA258" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Next Generation Matrix | Biostats E-book" />
  
  <meta name="twitter:description" content="Bookdown hosted on github using bookdown::gitbook." />
  

<meta name="author" content="Valerie Pan, Nishi Bhanderi, Shohan Ghatak, Bryce Morsky, Nishan Mudalige" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="equilibrium-stability-analysis.html"/>
<link rel="next" href="extended-compartmental-models-real-world-applications-and-solutions.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#sec:goal"><i class="fa fa-check"></i><b>1.1</b> Goals of this E-book</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#recommended-background"><i class="fa fa-check"></i><b>1.2</b> Recommended Background</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#history-of-mathematical-epidemiology"><i class="fa fa-check"></i><b>1.3</b> History of Mathematical Epidemiology</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#role-of-models-in-public-health"><i class="fa fa-check"></i><b>1.4</b> Role of Models in Public Health</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-mathematical-models-in-epidemiology.html"><a href="introduction-to-mathematical-models-in-epidemiology.html"><i class="fa fa-check"></i><b>2</b> Introduction to Mathematical Models in Epidemiology</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-mathematical-models-in-epidemiology.html"><a href="introduction-to-mathematical-models-in-epidemiology.html#sec:mathematical_models"><i class="fa fa-check"></i><b>2.1</b> Defining Mathematical Models</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-mathematical-models-in-epidemiology.html"><a href="introduction-to-mathematical-models-in-epidemiology.html#introduction-to-compartmental-modelling-thinking"><i class="fa fa-check"></i><b>2.2</b> Introduction to Compartmental Modelling Thinking</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="introduction-to-mathematical-models-in-epidemiology.html"><a href="introduction-to-mathematical-models-in-epidemiology.html#sec:compartments"><i class="fa fa-check"></i><b>2.2.1</b> Approach to Compartmental Modelling</a></li>
<li class="chapter" data-level="2.2.2" data-path="introduction-to-mathematical-models-in-epidemiology.html"><a href="introduction-to-mathematical-models-in-epidemiology.html#benefits-of-parsimonious-models"><i class="fa fa-check"></i><b>2.2.2</b> Benefits of Parsimonious Models</a></li>
<li class="chapter" data-level="2.2.3" data-path="introduction-to-mathematical-models-in-epidemiology.html"><a href="introduction-to-mathematical-models-in-epidemiology.html#limitations-of-compartmental-models"><i class="fa fa-check"></i><b>2.2.3</b> Limitations of Compartmental Models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="modelling-disease-dynamics-with-odes.html"><a href="modelling-disease-dynamics-with-odes.html"><i class="fa fa-check"></i><b>3</b> Modelling Disease Dynamics with ODEs</a>
<ul>
<li class="chapter" data-level="3.1" data-path="modelling-disease-dynamics-with-odes.html"><a href="modelling-disease-dynamics-with-odes.html#introduction-to-the-chapter"><i class="fa fa-check"></i><b>3.1</b> Introduction to the Chapter</a></li>
<li class="chapter" data-level="3.2" data-path="modelling-disease-dynamics-with-odes.html"><a href="modelling-disease-dynamics-with-odes.html#interactions-between-compartments"><i class="fa fa-check"></i><b>3.2</b> Interactions Between Compartments</a></li>
<li class="chapter" data-level="3.3" data-path="modelling-disease-dynamics-with-odes.html"><a href="modelling-disease-dynamics-with-odes.html#sec:SI_model"><i class="fa fa-check"></i><b>3.3</b> Solving the SI Model</a></li>
<li class="chapter" data-level="3.4" data-path="modelling-disease-dynamics-with-odes.html"><a href="modelling-disease-dynamics-with-odes.html#solving-the-sir-model"><i class="fa fa-check"></i><b>3.4</b> Solving the SIR Model</a></li>
<li class="chapter" data-level="3.5" data-path="modelling-disease-dynamics-with-odes.html"><a href="modelling-disease-dynamics-with-odes.html#interactive-dashboard"><i class="fa fa-check"></i><b>3.5</b> Interactive Dashboard</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="equilibrium-stability-analysis.html"><a href="equilibrium-stability-analysis.html"><i class="fa fa-check"></i><b>4</b> Equilibrium Stability Analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="equilibrium-stability-analysis.html"><a href="equilibrium-stability-analysis.html#introduction-to-the-chapter-1"><i class="fa fa-check"></i><b>4.1</b> Introduction to the Chapter</a></li>
<li class="chapter" data-level="4.2" data-path="equilibrium-stability-analysis.html"><a href="equilibrium-stability-analysis.html#linear-stability-analysis-for-the-sir-model"><i class="fa fa-check"></i><b>4.2</b> Linear Stability Analysis for the SIR Model</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="equilibrium-stability-analysis.html"><a href="equilibrium-stability-analysis.html#direct-calculation"><i class="fa fa-check"></i><b>4.2.1</b> Direct Calculation</a></li>
<li class="chapter" data-level="4.2.2" data-path="equilibrium-stability-analysis.html"><a href="equilibrium-stability-analysis.html#routh---hurwitz-criteria"><i class="fa fa-check"></i><b>4.2.2</b> Routh - Hurwitz Criteria</a></li>
<li class="chapter" data-level="4.2.3" data-path="equilibrium-stability-analysis.html"><a href="equilibrium-stability-analysis.html#descartes-rule-of-signs"><i class="fa fa-check"></i><b>4.2.3</b> Descartes’ Rule of Signs</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="equilibrium-stability-analysis.html"><a href="equilibrium-stability-analysis.html#linear-stability-analysis-for-the-si-model"><i class="fa fa-check"></i><b>4.3</b> Linear Stability Analysis for the SI Model</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="next-generation-matrix.html"><a href="next-generation-matrix.html"><i class="fa fa-check"></i><b>5</b> Next Generation Matrix</a>
<ul>
<li class="chapter" data-level="5.1" data-path="next-generation-matrix.html"><a href="next-generation-matrix.html#introduction-to-the-chapter-2"><i class="fa fa-check"></i><b>5.1</b> Introduction to the Chapter</a></li>
<li class="chapter" data-level="5.2" data-path="next-generation-matrix.html"><a href="next-generation-matrix.html#sec:ngmparameters"><i class="fa fa-check"></i><b>5.2</b> Definining the SEIR Model and Parameters</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="next-generation-matrix.html"><a href="next-generation-matrix.html#defining-the-disease-free-equilibrium-dfe"><i class="fa fa-check"></i><b>5.2.1</b> Defining the Disease Free Equilibrium (DFE)</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="next-generation-matrix.html"><a href="next-generation-matrix.html#sec:ngm"><i class="fa fa-check"></i><b>5.3</b> Solving SEIR Model with NGM</a></li>
<li class="chapter" data-level="5.4" data-path="next-generation-matrix.html"><a href="next-generation-matrix.html#solving-the-seir-model-with-birth-and-death"><i class="fa fa-check"></i><b>5.4</b> Solving the SEIR Model with Birth and Death</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="extended-compartmental-models-real-world-applications-and-solutions.html"><a href="extended-compartmental-models-real-world-applications-and-solutions.html"><i class="fa fa-check"></i><b>6</b> Extended Compartmental Models: Real World Applications and Solutions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="extended-compartmental-models-real-world-applications-and-solutions.html"><a href="extended-compartmental-models-real-world-applications-and-solutions.html#introduction-1"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="extended-compartmental-models-real-world-applications-and-solutions.html"><a href="extended-compartmental-models-real-world-applications-and-solutions.html#the-svir-model"><i class="fa fa-check"></i><b>6.2</b> The SVIR Model</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="extended-compartmental-models-real-world-applications-and-solutions.html"><a href="extended-compartmental-models-real-world-applications-and-solutions.html#model-formulation"><i class="fa fa-check"></i><b>6.2.1</b> Model Formulation</a></li>
<li class="chapter" data-level="6.2.2" data-path="extended-compartmental-models-real-world-applications-and-solutions.html"><a href="extended-compartmental-models-real-world-applications-and-solutions.html#solving-for-the-basic-reproduction-number"><i class="fa fa-check"></i><b>6.2.2</b> Solving for the Basic Reproduction Number</a></li>
<li class="chapter" data-level="6.2.3" data-path="extended-compartmental-models-real-world-applications-and-solutions.html"><a href="extended-compartmental-models-real-world-applications-and-solutions.html#computing-the-basic-reproduction-number-for-the-svir-model"><i class="fa fa-check"></i><b>6.2.3</b> Computing the Basic Reproduction Number for the SVIR Model</a></li>
<li class="chapter" data-level="6.2.4" data-path="extended-compartmental-models-real-world-applications-and-solutions.html"><a href="extended-compartmental-models-real-world-applications-and-solutions.html#linearization-around-the-disease-free-equilibrium"><i class="fa fa-check"></i><b>6.2.4</b> Linearization Around the Disease-Free Equilibrium</a></li>
<li class="chapter" data-level="6.2.5" data-path="extended-compartmental-models-real-world-applications-and-solutions.html"><a href="extended-compartmental-models-real-world-applications-and-solutions.html#jacobian-of-mathcalf"><i class="fa fa-check"></i><b>6.2.5</b> Jacobian of <span class="math inline">\(\mathcal{F}\)</span></a></li>
<li class="chapter" data-level="6.2.6" data-path="extended-compartmental-models-real-world-applications-and-solutions.html"><a href="extended-compartmental-models-real-world-applications-and-solutions.html#jacobian-of-mathcalv"><i class="fa fa-check"></i><b>6.2.6</b> Jacobian of <span class="math inline">\(\mathcal{V}\)</span></a></li>
<li class="chapter" data-level="6.2.7" data-path="extended-compartmental-models-real-world-applications-and-solutions.html"><a href="extended-compartmental-models-real-world-applications-and-solutions.html#forming-the-next-generation-matrix"><i class="fa fa-check"></i><b>6.2.7</b> Forming the Next-Generation Matrix</a></li>
<li class="chapter" data-level="6.2.8" data-path="extended-compartmental-models-real-world-applications-and-solutions.html"><a href="extended-compartmental-models-real-world-applications-and-solutions.html#computing-the-reproduction-number"><i class="fa fa-check"></i><b>6.2.8</b> Computing the Reproduction Number</a></li>
<li class="chapter" data-level="6.2.9" data-path="extended-compartmental-models-real-world-applications-and-solutions.html"><a href="extended-compartmental-models-real-world-applications-and-solutions.html#interpretation"><i class="fa fa-check"></i><b>6.2.9</b> Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="extended-compartmental-models-real-world-applications-and-solutions.html"><a href="extended-compartmental-models-real-world-applications-and-solutions.html#the-siqr-model"><i class="fa fa-check"></i><b>6.3</b> The SIQR Model</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="extended-compartmental-models-real-world-applications-and-solutions.html"><a href="extended-compartmental-models-real-world-applications-and-solutions.html#defining-the-parameters"><i class="fa fa-check"></i><b>6.3.1</b> Defining the Parameters</a></li>
<li class="chapter" data-level="6.3.2" data-path="extended-compartmental-models-real-world-applications-and-solutions.html"><a href="extended-compartmental-models-real-world-applications-and-solutions.html#defining-the-disease-free-equilibrium"><i class="fa fa-check"></i><b>6.3.2</b> Defining the Disease Free Equilibrium</a></li>
<li class="chapter" data-level="6.3.3" data-path="extended-compartmental-models-real-world-applications-and-solutions.html"><a href="extended-compartmental-models-real-world-applications-and-solutions.html#solving-the-siqr-model"><i class="fa fa-check"></i><b>6.3.3</b> Solving the SIQR Model</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="extended-compartmental-models-real-world-applications-and-solutions.html"><a href="extended-compartmental-models-real-world-applications-and-solutions.html#the-sair-model"><i class="fa fa-check"></i><b>6.4</b> The SAIR Model</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="extended-compartmental-models-real-world-applications-and-solutions.html"><a href="extended-compartmental-models-real-world-applications-and-solutions.html#defining-the-parameters-1"><i class="fa fa-check"></i><b>6.4.1</b> Defining the Parameters</a></li>
<li class="chapter" data-level="6.4.2" data-path="extended-compartmental-models-real-world-applications-and-solutions.html"><a href="extended-compartmental-models-real-world-applications-and-solutions.html#defining-the-disease-free-equilibrium-dfe-1"><i class="fa fa-check"></i><b>6.4.2</b> Defining the Disease Free Equilibrium (DFE)</a></li>
<li class="chapter" data-level="6.4.3" data-path="extended-compartmental-models-real-world-applications-and-solutions.html"><a href="extended-compartmental-models-real-world-applications-and-solutions.html#solving-sair-model-with-ngm"><i class="fa fa-check"></i><b>6.4.3</b> Solving SAIR Model with NGM</a></li>
<li class="chapter" data-level="6.4.4" data-path="extended-compartmental-models-real-world-applications-and-solutions.html"><a href="extended-compartmental-models-real-world-applications-and-solutions.html#example-parameters-and-simulation"><i class="fa fa-check"></i><b>6.4.4</b> Example Parameters and Simulation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="spatial-epidemiology.html"><a href="spatial-epidemiology.html"><i class="fa fa-check"></i><b>7</b> Spatial Epidemiology</a>
<ul>
<li class="chapter" data-level="7.1" data-path="spatial-epidemiology.html"><a href="spatial-epidemiology.html#introduction-to-spatial-epidemiology"><i class="fa fa-check"></i><b>7.1</b> Introduction to Spatial Epidemiology</a></li>
<li class="chapter" data-level="7.2" data-path="spatial-epidemiology.html"><a href="spatial-epidemiology.html#metapopulations"><i class="fa fa-check"></i><b>7.2</b> Metapopulations</a></li>
<li class="chapter" data-level="7.3" data-path="spatial-epidemiology.html"><a href="spatial-epidemiology.html#diffusion-and-travel"><i class="fa fa-check"></i><b>7.3</b> Diffusion and Travel</a></li>
<li class="chapter" data-level="7.4" data-path="spatial-epidemiology.html"><a href="spatial-epidemiology.html#networks"><i class="fa fa-check"></i><b>7.4</b> Networks</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="spatial-epidemiology.html"><a href="spatial-epidemiology.html#contact-heterogeneity"><i class="fa fa-check"></i><b>7.4.1</b> Contact Heterogeneity</a></li>
<li class="chapter" data-level="7.4.2" data-path="spatial-epidemiology.html"><a href="spatial-epidemiology.html#scale-free-networks"><i class="fa fa-check"></i><b>7.4.2</b> Scale Free Networks</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="spatial-epidemiology.html"><a href="spatial-epidemiology.html#ring-vaccination"><i class="fa fa-check"></i><b>7.5</b> Ring Vaccination</a></li>
<li class="chapter" data-level="7.6" data-path="spatial-epidemiology.html"><a href="spatial-epidemiology.html#agent-based-models"><i class="fa fa-check"></i><b>7.6</b> Agent-Based Models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Biostats E-book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="next-generation-matrix" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Next Generation Matrix<a href="next-generation-matrix.html#next-generation-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-to-the-chapter-2" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Introduction to the Chapter<a href="next-generation-matrix.html#introduction-to-the-chapter-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This chapter describes in depth the use of the <strong>Next Generation Matrix (NGM) method</strong>. This tool is used to calculate the <span class="math inline">\(R_0\)</span> value (<em>Definition</em> <a href="introduction.html#def:R0">1.3</a>). Using the NGM achieves this this for multi-compartmental models (e.g. SEIR), by linearizing the system of differential equations around the Disease-Free Equilibrium (DFE)
(<em>Definition</em> <a href="modelling-disease-dynamics-with-odes.html#def:DFE">3.3</a>) and dividing the flow of disease (<em>Definition</em> <a href="modelling-disease-dynamics-with-odes.html#def:Flow">3.1</a>) into
what causes new cases and what accounts for everything else that happens to an infected person. It is also important to mention that these tools are not limited to specific models and can be used for a variety of models.
This chapter will use the <strong>SEIR model</strong> as an example for applying the NGM method (recall the SEIR model from <em>Chapter</em> <a href="introduction-to-mathematical-models-in-epidemiology.html#sec:compartments">2.2.1</a>).</p>
</div>
<div id="sec:ngmparameters" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Definining the SEIR Model and Parameters<a href="next-generation-matrix.html#sec:ngmparameters" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The SEIR model expands on our previous SIR model with the additional compartment “Exposed”. This compartment represents individuals in the population that have been infected, but are not yet infectious.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:seirdiagram"></span>
<img src="_main_files/figure-html/seirdiagram-1.png" alt="The SEIR compartmental model." width="50%" />
<p class="caption">
Figure 5.1: The SEIR compartmental model.
</p>
</div>
<p>We define X as the vector of disease compartments. For the SEIR
model, <span class="math inline">\(X = \begin{bmatrix} E\\ I\\ \end{bmatrix}\)</span>. Note that for the SIR model,
<span class="math inline">\(X = \begin{bmatrix} I \end{bmatrix}\)</span>.</p>
<p>Then we can have:
<span class="math display">\[\frac{dX}{dt} = F(x) - V(x)\]</span></p>
<ul>
<li><p><span class="math inline">\(F(x)\)</span> is a vector of the terms that lead to new infections</p></li>
<li><p><span class="math inline">\(V(x) = V^- (x) -V^+ (x)\)</span> where <span class="math inline">\(V^- (x)\)</span> and <span class="math inline">\(-V^+ (x)\)</span> contain all
other outputs and inputs, respectively, for each disease compartment</p></li>
</ul>
<div id="defining-the-disease-free-equilibrium-dfe" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Defining the Disease Free Equilibrium (DFE)<a href="next-generation-matrix.html#defining-the-disease-free-equilibrium-dfe" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Disease Free Equilibrium exists when all infected compartments (I and E), are set to 0. i.e. <span class="math inline">\(E=0\)</span> and <span class="math inline">\(I=0\)</span>.</p>
<p><span class="math display">\[
\begin{align*}
\ \dot{S} &amp;= - \beta SI = 0\\
\ \dot{E} &amp;= \beta SI - \delta E = 0 \\
\ \dot{I} &amp;= \delta E - \gamma I = 0\\
\ \dot{R} &amp;= \gamma I = 0\\
\end{align*}
\]</span>
At the DFE:</p>
<ul>
<li><span class="math inline">\(\dot{S}\)</span> is true when I=0</li>
<li><span class="math inline">\(\dot{E}\)</span> is true when I=0 and E=0</li>
<li><span class="math inline">\(\dot{I}\)</span> is true when E=0 and I=0</li>
<li><span class="math inline">\(\dot{R}\)</span> is true when I=0</li>
</ul>
<p>Since there are no infections: <span class="math inline">\(E=I=R=0\)</span>
This means that for <span class="math inline">\(N=S+E+I+R\)</span>, <span class="math inline">\(N=S\)</span> due to our earlier statements
So at the DFE for the <span class="math inline">\((S,E,I,R) = (N,0,0,0)\)</span></p>
<p>This is important for understanding later substitutions in the Chapter.</p>
</div>
</div>
<div id="sec:ngm" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Solving SEIR Model with NGM<a href="next-generation-matrix.html#sec:ngm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Recall: that for the SEIR model the disease compartments are E and I</p>
<p><span class="math inline">\(\dot{X} = \begin{bmatrix} \dot{E}\\ \dot{I}\\ \end{bmatrix}\)</span></p>
<p><span class="math display">\[
\begin{align*}
\ \dot{S} &amp;= - \beta SI \\
\ \dot{E} &amp;= \beta SI - \delta E \\
\ \dot{I} &amp;= \delta E - \gamma I \\
\ \dot{R} &amp;= \gamma I \\
\end{align*}
\]</span></p>
<p>For the SIR model, <span class="math inline">\(X = \begin{bmatrix} I \end{bmatrix}\)</span>
For the SEIR Model:</p>
<p><span class="math display">\[
\begin{align*}
\ \dot{X} &amp;= \begin{bmatrix} \dot{E}\\ \dot{I}\\ \end{bmatrix} \\
\ \dot{X} &amp;= \begin{bmatrix} \beta SI - \delta E \\ \delta E - \gamma I \\ \end{bmatrix} \\
\ \dot{X} &amp;= \begin{bmatrix} \beta SI \\ 0 \\ \end{bmatrix} - \left( \begin{bmatrix} \delta E \\ \gamma I \\ \end{bmatrix} - \begin{bmatrix} 0 \\ \delta E \\ \end{bmatrix} \right) \\
\ \dot{X} &amp;= F(x) - ( V^- (x) -V^+ (x) ) \\
\end{align*}
\]</span></p>
<p>Note that the 0 in
<span class="math inline">\(F(x) = \begin{bmatrix} \beta SI \\ 0 \\ \end{bmatrix}\)</span> exists because
<span class="math inline">\(F\)</span> only considers brand new infected (the flow from <span class="math inline">\(S \rightarrow E\)</span>
and not <span class="math inline">\(S \rightarrow I\)</span>). I.e. infected, not necessarily infectious.</p>
<p>We separate the equation into components to assist us in our <span class="math inline">\(R_0\)</span>
calculations</p>
<p>For further simplicity, let:<br />
<span class="math display">\[
F(x) = \begin{bmatrix} \beta SI \\ 0 \\ \end{bmatrix} = \begin{bmatrix} F_1 \\ F_2 \\ \end{bmatrix}
\]</span></p>
<p>Also let:<br />
<span class="math display">\[
V(x) = \begin{bmatrix} \delta E \\ \gamma I - \delta E \\ \end{bmatrix} = \begin{bmatrix} V_1 \\ V_2 \\ \end{bmatrix}
\]</span></p>
<p>Find the Jacobians of F(x) and V(x) at the disease free equilibrium
(DFE):</p>
<p>Let the Jacobian of F(x) be <strong>F</strong>.</p>
<p><span class="math display">\[
\boldsymbol{F} = J_F (x) = \begin{bmatrix}
\frac{\partial F_1}{\partial E} &amp; \frac{\partial F_1}{\partial I} \\
\frac{\partial F_2}{\partial E} &amp; \frac{\partial F_2}{\partial I} \\
\end{bmatrix}
= \begin{bmatrix}
0 &amp; \beta S \\
0 &amp; 0 \\
\end{bmatrix}
\]</span></p>
<p>At DFE, <span class="math inline">\(S = 1\)</span></p>
<ul>
<li>This is found by our earlier definition of the DFE.
<ul>
<li>At the DFE for (S,E,I,R) = (N,0,0,0)</li>
<li>Since Population <span class="math inline">\(&quot;N&quot;=1\)</span> and <span class="math inline">\(S=N\)</span>, then <span class="math inline">\(S=1\)</span></li>
</ul></li>
<li>So after subsituting <span class="math inline">\(S=1\)</span>:</li>
</ul>
<p><span class="math display">\[
J_F (x)
= \begin{bmatrix}
0 &amp; \beta \\
0 &amp; 0 \\
\end{bmatrix}
\]</span></p>
<p>Let the Jacobian of V(x) be <strong>V</strong>.</p>
<p><span class="math display">\[
\boldsymbol{V} = J_V (x) = \begin{bmatrix}
\frac{\partial V_1}{\partial E} &amp; \frac{\partial V_1}{\partial I} \\
\frac{\partial V_2}{\partial E} &amp; \frac{\partial V_2}{\partial I} \\
\end{bmatrix}
= \begin{bmatrix}
\delta &amp; 0 \\
-\delta &amp; \gamma \\
\end{bmatrix}
\]</span></p>
<p>Another way to think about it:
<span class="math inline">\(\dot{X} = (f-v) \begin{bmatrix} E \\ I \end{bmatrix} = (f-v)X\)</span></p>
<p>Now find the NGM.</p>
<p><span class="math inline">\(NGM = \boldsymbol{F} \boldsymbol{V}^{-1}\)</span></p>
<p>The NGM for this is <span class="math display">\[
\boldsymbol{F} = \begin{bmatrix}
0 &amp; \beta \\
0 &amp; 0 \\
\end{bmatrix}
\]</span></p>
<p>and by the rule: for matrix
<span class="math inline">\(M = \begin{bmatrix} a &amp; b \\ c &amp; d \\ \end{bmatrix}\)</span> the inverse
<span class="math inline">\(M^{-1} = \frac{1}{ad-bc} \begin{bmatrix} d &amp; -b \\ -c &amp; a \\ \end{bmatrix}\)</span></p>
<p>Then for <span class="math inline">\(\boldsymbol{V} ^{-1}\)</span> we get <span class="math display">\[
\boldsymbol{V} ^{-1} = \frac{1}{\delta \gamma} \begin{bmatrix}
\gamma &amp; 0 \\
\delta &amp; \delta \\
\end{bmatrix}
\]</span></p>
<p><span class="math display">\[
\begin{align*}
\ \boldsymbol{F} \boldsymbol{V} ^{-1} &amp;= \begin{bmatrix} 0 &amp; \beta \\ 0 &amp; 0 \\ \end{bmatrix}
\frac{1}{\delta \gamma}
\begin{bmatrix} \gamma &amp; 0 \\ \delta &amp; \delta \\ \end{bmatrix} \\
\ &amp;= \begin{bmatrix} 0 &amp; \beta \\ 0 &amp; 0 \\ \end{bmatrix}
\begin{bmatrix} \frac{1}{\delta} &amp; 0 \\ \frac{1}{\gamma} &amp; \frac{1}{\gamma} \\ \end{bmatrix} \\
\ &amp;= \begin{bmatrix} \frac{\beta}{\gamma} &amp; \frac{\beta}{\gamma} \\ 0 &amp; 0 \\ \end{bmatrix} \\
\end{align*}
\]</span></p>
<p>Refer back to the formula in (<em>Chapter</em> <a href="equilibrium-stability-analysis.html#sec:dfeesa">4.2.1.1</a>), where <span class="math inline">\(det(J-\lambda I_n) = 0\)</span>. <span class="math inline">\(R_0\)</span> is the spectral radius (i.e. largest eigenvalue) of <span class="math inline">\(\ \boldsymbol{F} \boldsymbol{V} ^{-1}\)</span>.</p>
<p><span class="math display">\[
det \left( \begin{bmatrix}
\frac{\beta}{\gamma} - \lambda &amp; \frac{\beta}{\gamma} \\
0 &amp; - \lambda \\
\end{bmatrix} \right)
= - \lambda \left( \frac{\beta}{\gamma} - \lambda \right)
\]</span></p>
<p>Let <span class="math inline">\(- \lambda \left( \frac{\beta}{\gamma} - \lambda \right) = 0\)</span>.</p>
<p>So <span class="math inline">\(\lambda = 0\)</span> and <span class="math inline">\(\lambda = \frac{\beta}{\gamma}\)</span>. The latter is the
largest eigenvalue, so <span class="math inline">\(R_0 = \lambda = \frac{\beta}{\gamma}\)</span>.</p>
</div>
<div id="solving-the-seir-model-with-birth-and-death" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Solving the SEIR Model with Birth and Death<a href="next-generation-matrix.html#solving-the-seir-model-with-birth-and-death" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="math display">\[S+E+I+R=N\]</span>
In this version of the SEIR model, demographic effects such as births and deaths are included to make the model more realistic.</p>
<p><span class="math inline">\(\mu N\)</span> represents births in the system.</p>
<p><span class="math inline">\(\mu\)</span> represents deaths.</p>
<p>The birth term <span class="math inline">\(\mu N\)</span> adds to the susceptible population, while the deaths occur at a rate <span class="math inline">\(\mu\)</span> across the four compartments.</p>
<p>The four differential equations can then be constructed, however for the next generation model we only care about <span class="math inline">\(\dot{E}\)</span> and <span class="math inline">\(\dot{I}\)</span>, since they represent the infected compartments.</p>
<p><span class="math display">\[\begin{align*}
\dot{S} &amp;= \mu N - \frac{\beta SI}{N} \\
\dot{R} &amp;= \gamma I - \mu R \\

\dot{E} &amp;= \frac{\beta SI}{N} - (\sigma + \mu)E \\
\dot{I} &amp;= \sigma E - (\gamma + \mu)I
\end{align*}\]</span></p>
<p>At the disease-free equilibrium (DFE), there are no infections (<span class="math inline">\(E = 0\)</span> and <span class="math inline">\(I = 0\)</span>).
From the first equation, <span class="math inline">\(\dot{S} = 0\)</span> when <span class="math inline">\(S = N\)</span>, meaning the entire population is susceptible.
We use this equilibrium to linearize the system and separate infection terms (<span class="math inline">\(F(x)\)</span>) from other transition terms (<span class="math inline">\(V(x)\)</span>).</p>
<p>Next Generation Model:
<span class="math display">\[
\begin{align*}
\dot(x) &amp;= F(x) - V(x) \\
&amp;= \begin{bmatrix}
\frac{\beta SI}{N} \\
0
\end{bmatrix} -
\begin{bmatrix}
(\sigma + \mu)E \\
(\gamma + \mu)I - \sigma E
\end{bmatrix}
\end{align*}
\]</span></p>
<p>Here, the first vector <span class="math inline">\(F(x)\)</span> captures new infections — in this case, the flow from the susceptible compartment <span class="math inline">\(S\)</span> to the exposed compartment <span class="math inline">\(E\)</span>.
The second vector, <span class="math inline">\(V(x)\)</span>, represents all other movements between infected compartments (progression, recovery, and death).</p>
<p>The Jacobian of <span class="math inline">\(F(x)\)</span> is
<span class="math display">\[
\begin{bmatrix}
0 &amp; \frac{\beta S}{N} \\
0 &amp; 0
\end{bmatrix}
\]</span></p>
<p>And since at the DFE S is equal to N,
<span class="math display">\[
\textbf{F} = \begin{bmatrix} 0 &amp;\beta \\0&amp;0 \end{bmatrix}
\]</span>
The Jacobian of <span class="math inline">\(V(x)\)</span> is
<span class="math display">\[
\textbf{V} = \begin{bmatrix} \sigma + \mu &amp; 0 \\ -\sigma &amp; \gamma + \mu \end{bmatrix}
\]</span>
Next gen matrix is
<span class="math display">\[
\begin{align*}
FV^{-1} &amp;=
\begin{bmatrix}
0 &amp; \beta \\
0 &amp; 0
\end{bmatrix}
\frac{1}{(\sigma + \mu)(\gamma + \mu)}
\begin{bmatrix}
\gamma + \mu &amp; 0 \\
\sigma &amp; \sigma + \mu
\end{bmatrix} \\
&amp;=
\begin{bmatrix}
\frac{\beta \sigma}{(\sigma + \mu)(\gamma + \mu)} &amp; \frac{\beta}{\gamma + \mu} \\
0 &amp; 0
\end{bmatrix}
\end{align*}
\]</span>
Multiplying <span class="math inline">\(F\)</span> by <span class="math inline">\(V^{-1}\)</span> captures how many new infections one infected individual generates in each compartment over their infectious period.</p>
<p>The resulting matrix describes the expected number of new infections caused by an exposed or infectious person.
The basic reproduction number <span class="math inline">\(R_0\)</span> is given by the the largest eigenvalue of the next generation matrix.</p>
<p>The largest eigenvalue is :
<span class="math inline">\(\frac{\beta \sigma}{(\sigma + \mu)(\gamma +\mu)} = R_0\)</span></p>
<p>This value shows how the disease’s ability to spread depends not only on transmission (<span class="math inline">\(\beta\)</span>) and recovery (<span class="math inline">\(\gamma\)</span>), but also on the rates of progression (<span class="math inline">\(\sigma\)</span>) and death (<span class="math inline">\(\mu\)</span>).
If <span class="math inline">\(\mu = 0\)</span>, meaning no births or deaths occur, this expression simplifies to <span class="math inline">\(R_0 = \frac{\beta}{\gamma}\)</span> which is the classic SIR result.</p>
<p>References: <span class="citation">[<a href="references.html#ref-blackwood2018">12</a>]</span></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="equilibrium-stability-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="extended-compartmental-models-real-world-applications-and-solutions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
